<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>多语言支持 &#8212; Ren&#39;Py 中文文档</title>
    <link rel="stylesheet" href="_static/renpydoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-sphinx.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="可视组件" href="displayables.html" />
    <link rel="prev" title="文本" href="text.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="index.html">
          Ren&#39;Py 中文文档</a>
        <span class="navbar-text navbar-version pull-left"><b>7.0.1</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="https://www.renpy.org">官方主页</a></li>
                <li><a href="https://www.renpy.cn/forum.php/">Ren&#39;Py中文空间</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">快速入门</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui.html">GUI(图形用户接口)定制化指导</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="language_basics.html">编程语言基础</a></li>
<li class="toctree-l1"><a class="reference internal" href="label.html">脚本标签(label)和主控流程</a></li>
<li class="toctree-l1"><a class="reference internal" href="dialogue.html">对话(dialogue)和旁白(narration)</a></li>
<li class="toctree-l1"><a class="reference internal" href="displaying_images.html">显示图像</a></li>
<li class="toctree-l1"><a class="reference internal" href="menus.html">游戏内菜单</a></li>
<li class="toctree-l1"><a class="reference internal" href="python.html">Python语句</a></li>
<li class="toctree-l1"><a class="reference internal" href="conditional.html">条件语句</a></li>
<li class="toctree-l1"><a class="reference internal" href="audio.html">音频</a></li>
<li class="toctree-l1"><a class="reference internal" href="movie.html">影片</a></li>
<li class="toctree-l1"><a class="reference internal" href="voice.html">语音</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="text.html">文本</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">多语言支持</a></li>
<li class="toctree-l1"><a class="reference internal" href="displayables.html">可视组件</a></li>
<li class="toctree-l1"><a class="reference internal" href="transforms.html">变换</a></li>
<li class="toctree-l1"><a class="reference internal" href="transitions.html">转场(transition)</a></li>
<li class="toctree-l1"><a class="reference internal" href="atl.html">动画和变换语言</a></li>
<li class="toctree-l1"><a class="reference internal" href="layeredimage.html">层叠式图像</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="style.html">样式(style)</a></li>
<li class="toctree-l1"><a class="reference internal" href="style_properties.html">样式特性(property)</a></li>
<li class="toctree-l1"><a class="reference internal" href="screens.html">界面和界面语言</a></li>
<li class="toctree-l1"><a class="reference internal" href="screen_actions.html">界面动作(action)、值(value)和函数</a></li>
<li class="toctree-l1"><a class="reference internal" href="screen_special.html">特殊界面名称</a></li>
<li class="toctree-l1"><a class="reference internal" href="screen_optimization.html">界面语言优化</a></li>
<li class="toctree-l1"><a class="reference internal" href="config.html">配置项变量</a></li>
<li class="toctree-l1"><a class="reference internal" href="preferences.html">环境设定配置</a></li>
<li class="toctree-l1"><a class="reference internal" href="store_variables.html">存储区配置项</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="developer_tools.html">开发者工具</a></li>
<li class="toctree-l1"><a class="reference internal" href="director.html">交互式指导器(interactive director)</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="nvl_mode.html">NVL模式教程</a></li>
<li class="toctree-l1"><a class="reference internal" href="input.html">文本输入</a></li>
<li class="toctree-l1"><a class="reference internal" href="side_image.html">头像</a></li>
<li class="toctree-l1"><a class="reference internal" href="rooms.html">画廊、音乐空间和场景回放</a></li>
<li class="toctree-l1"><a class="reference internal" href="drag_drop.html">拖放组件</a></li>
<li class="toctree-l1"><a class="reference internal" href="sprites.html">精灵(sprite)</a></li>
<li class="toctree-l1"><a class="reference internal" href="keymap.html">定制按键映射</a></li>
<li class="toctree-l1"><a class="reference internal" href="achievement.html">成就</a></li>
<li class="toctree-l1"><a class="reference internal" href="history.html">对话历史</a></li>
<li class="toctree-l1"><a class="reference internal" href="multiple.html">多角色对话</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="statement_equivalents.html">等效语句</a></li>
<li class="toctree-l1"><a class="reference internal" href="save_load_rollback.html">存档、读档和回滚</a></li>
<li class="toctree-l1"><a class="reference internal" href="persistent.html">持久化数据</a></li>
<li class="toctree-l1"><a class="reference internal" href="trans_trans_python.html">Python中的变换(transform)和转场(transition)</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui_advanced.html">高级GUI</a></li>
<li class="toctree-l1"><a class="reference internal" href="screen_python.html">界面与Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="modes.html">模式</a></li>
<li class="toctree-l1"><a class="reference internal" href="udd.html">创作者定义的可视组件</a></li>
<li class="toctree-l1"><a class="reference internal" href="cds.html">创作者定义的语句</a></li>
<li class="toctree-l1"><a class="reference internal" href="custom_text_tags.html">定制文本标签</a></li>
<li class="toctree-l1"><a class="reference internal" href="character_callbacks.html">角色回调函数</a></li>
<li class="toctree-l1"><a class="reference internal" href="file_python.html">文件读写</a></li>
<li class="toctree-l1"><a class="reference internal" href="color_class.html">Color类</a></li>
<li class="toctree-l1"><a class="reference internal" href="other.html">其他函数和配置变量</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="build.html">生成分发版</a></li>
<li class="toctree-l1"><a class="reference internal" href="updater.html">web更新器</a></li>
<li class="toctree-l1"><a class="reference internal" href="android.html">安卓(Android)</a></li>
<li class="toctree-l1"><a class="reference internal" href="chromeos.html">Chrome OS/Chrome浏览器</a></li>
<li class="toctree-l1"><a class="reference internal" href="ios.html">iOS</a></li>
<li class="toctree-l1"><a class="reference internal" href="iap.html">程序内购</a></li>
<li class="toctree-l1"><a class="reference internal" href="gesture.html">手势</a></li>
<li class="toctree-l1"><a class="reference internal" href="raspi.html">树莓派</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="problems.html">处理故障</a></li>
<li class="toctree-l1"><a class="reference internal" href="environment_variables.html">环境变量</a></li>
<li class="toctree-l1"><a class="reference internal" href="self_voicing.html">自动语音</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="editor.html">集成文本编辑器</a></li>
<li class="toctree-l1"><a class="reference internal" href="skins.html">皮肤</a></li>
<li class="toctree-l1"><a class="reference internal" href="translating_renpy.html">Ren’Py多语言支持</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">完整变更日志</a></li>
<li class="toctree-l1"><a class="reference internal" href="incompatible.html">Incompatible Changes</a></li>
<li class="toctree-l1"><a class="reference internal" href="distributor.html">Distributor Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="credits.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="sponsors.html">Ren’Py Development Sponsors</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="thequestion.html">Script of The Question</a></li>
<li class="toctree-l1"><a class="reference internal" href="thequestion_nvl.html">NVL-模式 “The Question” 脚本</a></li>
</ul>
</ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="搜索" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><ul>
<li><a class="reference internal" href="#">多语言支持</a><ul>
<li><a class="reference internal" href="#primary-and-alternate-languages">主语言和备选语言</a></li>
<li><a class="reference internal" href="#generating-translation-files">生成翻译文件</a></li>
<li><a class="reference internal" href="#translating-dialogue">多语言对话</a><ul>
<li><a class="reference internal" href="#translation-units">多语言支持的单元</a></li>
<li><a class="reference internal" href="#translate">translate语句</a></li>
<li><a class="reference internal" href="#more-complex-translations">更复杂的多语言支持</a></li>
<li><a class="reference internal" href="#tips">小贴士</a></li>
</ul>
</li>
<li><a class="reference internal" href="#string-translations">菜单和字符串的多语言支持</a><ul>
<li><a class="reference internal" href="#translating-substitutions">多语言替换</a></li>
<li><a class="reference internal" href="#extract-merge-translations">提取和复用多语言字符串</a></li>
</ul>
</li>
<li><a class="reference internal" href="#image-and-file-translations">图片和文件的多语言支持</a></li>
<li><a class="reference internal" href="#style-translations">样式的多语言支持</a></li>
<li><a class="reference internal" href="#default-language">默认语言</a></li>
<li><a class="reference internal" href="#translation-actions-functions-and-variables">多语言支持的动作、函数和变量</a></li>
<li><a class="reference internal" href="#unsanctioned-translations">非常规多语言支持</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    <div class="col-md-9 content">
      
  <div class="section" id="translation">
<span id="id1"></span><h1>多语言支持<a class="headerlink" href="#translation" title="Permalink to this headline"> link</a></h1>
<p>(译者注：原文为“Translation”。将translation直译为“翻译”，容易引发歧义，所以文档中单独出现时一律使用“多语言支持”，“translation file”则翻译为“翻译文件”。)
Ren’Py包含了视觉系小说多语言支持的综合框架。有4类要素支持多语言：</p>
<dl class="docutils">
<dt>对话</dt>
<dd>脚本的主对话能够支持多语言，包括各行文本内容的分割、合并、删除和调整的一套规则。</dd>
<dt>菜单和接口字符串</dt>
<dd>所有接口文本都支持多语言。</dd>
<dt>图像和文件</dt>
<dd>选择某种语言时，可以使用对应的一系列图片和其他文件。</dd>
<dt>样式</dt>
<dd>可以基于语言实现样式定制化，这样游戏会自动切换为对应某种语言的样式。</dd>
</dl>
<p>目前Ren’Py的多语言支持主要聚焦在标准化的多语言支持。如果实现的话，创作者就可以使用将游戏脚本直接扔给多语言解释器，或者自己创建多语言模板。目前支持的非标准化多语言支持有诸多限制。</p>
<div class="section" id="primary-and-alternate-languages">
<span id="id2"></span><h2>主语言和备选语言<a class="headerlink" href="#primary-and-alternate-languages" title="Permalink to this headline"> link</a></h2>
<p>Ren’Py需要每一个作品都使用一种主语言编写。这种主语言无论具体是哪国的，都被称作 <code class="docutils literal notranslate"><span class="pre">None</span></code> 语言。(如果使用英语编写，英语就是 <code class="docutils literal notranslate"><span class="pre">None</span></code> 语言。)</p>
<p>当选择使用None语言后，Ren’Py的大多数多语言支持功能都会关闭。</p>
<p>备选语言在作品中出现时，推荐使用原来的Python标识符连写两次。(格式为，以字母或下划线开头，后面跟字母、数字或者下划线。)</p>
</div>
<div class="section" id="generating-translation-files">
<span id="id3"></span><h2>生成翻译文件<a class="headerlink" href="#generating-translation-files" title="Permalink to this headline"> link</a></h2>
<p>当项目脚本是正常可用的情况下，我们可以在Ren’Py启动器中选择“生成翻译文件”。启动器将提示你需要生成的语言名称，然后创建或更新翻译文件。</p>
<p>翻译文件是在game文件夹中一个名为“tl”的子文件夹下的同名目录中。例如，如果你为tutorial项目创建了piglatin的语言支持，对应的语言支持文件将会放在 <code class="docutils literal notranslate"><span class="pre">tutorial/game/tl/piglatin</span></code> 目录下。</p>
<p>每一个游戏脚本文件都会被创建对应的翻译文件。common.rpy文件也会被创建，其内容包含所有Ren’Py制作游戏使用的通用字符串的多语言支持。</p>
</div>
<div class="section" id="translating-dialogue">
<span id="id4"></span><h2>多语言对话<a class="headerlink" href="#translating-dialogue" title="Permalink to this headline"> link</a></h2>
<p>因为Ren’Py是一个视觉系小说引擎，我们最需要的自然就是对话的多语言支持。Ren’Py包含了一个具有可塑性的框架，允许对话内容的分割、合并、调整顺序及整段删除。</p>
<div class="section" id="translation-units">
<span id="id5"></span><h3>多语言支持的单元<a class="headerlink" href="#translation-units" title="Permalink to this headline"> link</a></h3>
<p>一个由0个或多个可支持多语言的语句构成的语句块(block)是多语言支持的基础单元，后面可选加上一条say语句。可支持多语言的语句包括voice和nvl语句。例如下面脚本中的：</p>
<div class="highlight-renpy notranslate"><div class="highlight"><pre><span></span><span class="k">label</span> <span class="n">start</span><span class="p">:</span>
    <span class="n">e</span> <span class="s2">&quot;Thank you for taking a look at the Ren&#39;Py translation framework.&quot;</span>

    <span class="k">show</span> <span class="n">eileen</span> <span class="n">happy</span>

    <span class="n">e</span> <span class="s2">&quot;We aim to provide a comprehensive framework for translating dialogue, strings, images, and styles.&quot;</span>

    <span class="n">e</span> <span class="s2">&quot;Pretty much everything your game needs!&quot;</span>
</pre></div>
</div>
<p>这段脚本可以分割为多个多语言支持单元。每个单元都有对应的一个标识符用于声明该单元。标识符根据单元前的脚本标签(label)和单元内的语句来生成。(如果多个单元被声明为同一个多语言数字，从第二个单元开始会自动添加上一个自然数编号便于区分。)</p>
<p>在上面的样例脚本中，第一个单元生成的标识号为start_636ae3f5，包含这条语句：</p>
<div class="highlight-renpy notranslate"><div class="highlight"><pre><span></span><span class="n">e</span> <span class="s2">&quot;Thank you for taking a look at the Ren&#39;Py translation framework.&quot;</span>
</pre></div>
</div>
<p>第二个单元的标识号是start_bd1ad9e1m，包含这条语句：</p>
<div class="highlight-renpy notranslate"><div class="highlight"><pre><span></span><span class="n">e</span> <span class="s2">&quot;We aim to provide a comprehensive framework for translating dialogue, strings, images, and styles.&quot;</span>
</pre></div>
</div>
<p>第三个单元的标识号是start_9e949aac，包含这条语句：</p>
<div class="highlight-renpy notranslate"><div class="highlight"><pre><span></span><span class="n">e</span> <span class="s2">&quot;Pretty much everything your game needs!&quot;</span>
</pre></div>
</div>
<p>当游戏脚本加载时，这些多语言支持的单元会被Ren’Py自动创建。</p>
</div>
<div class="section" id="translate">
<span id="translate-statement"></span><h3>translate语句<a class="headerlink" href="#translate" title="Permalink to this headline"> link</a></h3>
<p>当你生成了对某种语言的支持时，Ren’Py会针对每一个多语言支持单元生成一条translate语句。我们再以刚才的那段脚本举例，Ren’Py生成的语句如下：</p>
<div class="highlight-renpy notranslate"><div class="highlight"><pre><span></span><span class="c1"># game/script.rpy:95</span>
<span class="k">translate</span> <span class="n">piglatin</span> <span class="n">start_636ae3f5</span><span class="p">:</span>

    <span class="c1"># e &quot;Thank you for taking a look at the Ren&#39;Py translation framework.&quot;</span>
    <span class="n">e</span> <span class="s2">&quot;&quot;</span>

<span class="c1"># game/script.rpy:99</span>
<span class="k">translate</span> <span class="n">piglatin</span> <span class="n">start_bd1ad9e1</span><span class="p">:</span>

    <span class="c1"># e &quot;We aim to provide a comprehensive framework for translating dialogue, strings, images, and styles.&quot;</span>
    <span class="n">e</span> <span class="s2">&quot;&quot;</span>

<span class="c1"># game/script.rpy:101</span>
<span class="k">translate</span> <span class="n">piglatin</span> <span class="n">start_9e949aac</span><span class="p">:</span>

    <span class="c1"># e &quot;Pretty much everything your game needs!&quot;</span>
    <span class="n">e</span> <span class="s2">&quot;&quot;</span>
</pre></div>
</div>
<p>编辑这个文件就可以实现对piglatin语言的支持了。完成编辑后的样子如下：</p>
<div class="highlight-renpy notranslate"><div class="highlight"><pre><span></span><span class="c1"># game/script.rpy:95</span>
<span class="k">translate</span> <span class="n">piglatin</span> <span class="n">start_636ae3f5</span><span class="p">:</span>
    <span class="c1"># e &quot;Thank you for taking a look at the Ren&#39;Py translation framework.&quot;</span>
    <span class="n">e</span> <span class="s2">&quot;Ankthay ouyay orfay akingtay away ooklay atway ethay En&#39;Pyray anslationtray ameworkfray.&quot;</span>

<span class="c1"># game/script.rpy:99</span>
<span class="k">translate</span> <span class="n">piglatin</span> <span class="n">start_bd1ad9e1</span><span class="p">:</span>

    <span class="c1"># e &quot;We aim to provide a comprehensive framework for translating dialogue, strings, images, and styles.&quot;</span>
    <span class="n">e</span> <span class="s2">&quot;Eway aimway otay ovidepray away omprehensivecay ameworkfray orfay anslatingtray ialogueday, ingsstray, imagesway, andway ylesstay.&quot;</span>

<span class="c1"># game/script.rpy:101</span>
<span class="k">translate</span> <span class="n">piglatin</span> <span class="n">start_9e949aac</span><span class="p">:</span>

    <span class="c1"># e &quot;Pretty much everything your game needs!&quot;</span>
    <span class="n">e</span> <span class="s2">&quot;Ettypray uchmay everythingway ouryay amegay eedsnay!&quot;</span>
</pre></div>
</div>
<p>当引擎在主线脚本中遇到一个语句块(block)，Ren’Py就会检查是否存在对应的translate语句存在。如果存在的话，Ren’Py将会执行translate语句，并向用户显示对应语言的内容。</p>
</div>
<div class="section" id="more-complex-translations">
<span id="id6"></span><h3>更复杂的多语言支持<a class="headerlink" href="#more-complex-translations" title="Permalink to this headline"> link</a></h3>
<p>translate语句中数量并不要求与原语言语句数量保持1比1。例如，一行很长的语句可以分割：</p>
<div class="highlight-renpy notranslate"><div class="highlight"><pre><span></span><span class="c1"># game/script.rpy:99</span>
<span class="k">translate</span> <span class="n">piglatin</span> <span class="n">start_bd1ad9e1</span><span class="p">:</span>
    <span class="c1"># e &quot;We aim to provide a comprehensive framework for translating dialogue, strings, images, and styles.&quot;</span>
    <span class="n">e</span> <span class="s2">&quot;Eway aimway otay ovidepray away omprehensivecay ameworkfray...&quot;</span>
    <span class="n">e</span> <span class="s2">&quot;...orfay anslatingtray ialogueday, ingsstray, imagesway, andway ylesstay.&quot;</span>
</pre></div>
</div>
<p>或者某条语句可以移除，并用pass语句代替。:</p>
<div class="highlight-renpy notranslate"><div class="highlight"><pre><span></span><span class="c1"># game/script.rpy:101</span>
<span class="k">translate</span> <span class="n">piglatin</span> <span class="n">start_9e949aac</span><span class="p">:</span>

     <span class="c1"># e &quot;Pretty much everything your game needs!&quot;</span>
     <span class="k">pass</span>
</pre></div>
</div>
<p>甚至可以运行非对话型的语句，比如条件语句或者Python语句。例如，我们可以把下面这句：</p>
<div class="highlight-renpy notranslate"><div class="highlight"><pre><span></span><span class="n">e</span> <span class="s2">&quot;You scored [points] points!&quot;</span>
</pre></div>
</div>
<p>在其他语言中写成：</p>
<div class="highlight-renpy notranslate"><div class="highlight"><pre><span></span><span class="c1"># game/script.rpy:103</span>
<span class="k">translate</span> <span class="n">piglatin</span> <span class="n">start_36562aba</span><span class="p">:</span>

    <span class="c1"># e &quot;You scored [points] points!&quot;</span>
    <span class="n">e</span> <span class="k">$</span> <span class="n">latin_points</span> <span class="o">=</span> <span class="n">to_roman_numerals</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
    <span class="n">e</span> <span class="s2">&quot;Ouyay oredscay [latin_points] ointspay!&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="tips">
<span id="id7"></span><h3>小贴士<a class="headerlink" href="#tips" title="Permalink to this headline"> link</a></h3>
<p>在处理多语言支持的对话内容时必须非常小心，特别是某个脚本标签(label)下某个对话内容重复多次的情况。在某些时候，有必要在主语言脚本中直接声明多语言支持的标识符，像这条语句：</p>
<div class="highlight-renpy notranslate"><div class="highlight"><pre><span></span><span class="k">translate</span> <span class="bp">None</span> <span class="n">mylable_03ac197e_1</span><span class="p">:</span>
    <span class="s2">&quot;...&quot;</span>
</pre></div>
</div>
<p>增加文本标签(label)也可能会导致多语言支持冲突。为了防止这种情况出现，脚本标签(label)后加上一个hide分句就可以在翻译文件生成时忽略这个标签：</p>
<div class="highlight-renpy notranslate"><div class="highlight"><pre><span></span><span class="k">label</span> <span class="n">ignored_by_translation</span> <span class="k">hide</span><span class="p">:</span>
    <span class="s2">&quot;...&quot;</span>
</pre></div>
</div>
<p>由于多语言语句块(block)中可以包含Python语句，这些Python语句不应该在超过其所处语句块(block)之外造成任何副作用。这是因为，切换语言会重启多语言支持语句块(block)，语句块内的Python语句的副作用会发生多次。</p>
</div>
</div>
<div class="section" id="string-translations">
<span id="id8"></span><h2>菜单和字符串的多语言支持<a class="headerlink" href="#string-translations" title="Permalink to this headline"> link</a></h2>
<p>除了对话，Ren’Py也可以提供菜单与其他字符串内文本的多语言支持。接口的各种语言文本条数是严格1比1对应的。某个字符串被对上的话，就能被另一种语言的字符串替换。</p>
<p>当生成翻译文件时，Ren’Py会扫描脚本文件中的菜单和 _()函数中定义的字符串。然后它会将这些字符串内容放入一个多语言字符串语句块(block)中。例如，如果我们有如下的脚本内容：</p>
<div class="highlight-renpy notranslate"><div class="highlight"><pre><span></span><span class="k">define</span> <span class="n">e</span> <span class="o">=</span> <span class="n">Character</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s2">&quot;Eileen&quot;</span><span class="p">))</span>

<span class="c1"># ...</span>

<span class="k">menu</span><span class="p">:</span>

     <span class="s2">&quot;Go West&quot;</span><span class="p">:</span>
        <span class="c1"># ...</span>

     <span class="s2">&quot;Head East&quot;</span><span class="p">:</span>
        <span class="c1"># ...</span>
</pre></div>
</div>
<p>Ren’Py会自动生成：</p>
<div class="highlight-renpy notranslate"><div class="highlight"><pre><span></span><span class="k">translate</span> <span class="n">piglatin</span> <span class="k">strings</span><span class="p">:</span>

    <span class="k">old</span> <span class="s2">&quot;Eileen&quot;</span>
    <span class="k">new</span> <span class="s2">&quot;&quot;</span>

    <span class="k">old</span> <span class="s2">&quot;Go West&quot;</span>
    <span class="k">new</span> <span class="s2">&quot;&quot;</span>

    <span class="k">old</span> <span class="s2">&quot;Head East&quot;</span>
    <span class="k">new</span> <span class="s2">&quot;&quot;</span>
</pre></div>
</div>
<p>完成后的多语言支持内容为：</p>
<div class="highlight-renpy notranslate"><div class="highlight"><pre><span></span><span class="k">translate</span> <span class="n">piglatin</span> <span class="k">strings</span><span class="p">:</span>

    <span class="k">old</span> <span class="s2">&quot;Eileen&quot;</span>
    <span class="k">new</span> <span class="s2">&quot;Eileenway&quot;</span>

    <span class="k">old</span> <span class="s2">&quot;Go West&quot;</span>
    <span class="k">new</span> <span class="s2">&quot;Ogay Estway&quot;</span>

    <span class="k">old</span> <span class="s2">&quot;Head East&quot;</span>
    <span class="k">new</span> <span class="s2">&quot;Eadhay Eastway&quot;</span>
</pre></div>
</div>
<p>字符串的多语言支持用于在对话中插入的某些字符串。那些字符串不能以对话形式支持多语言。</p>
<p>如果某个字符串同时用在多处，可以使用{#…}文本标签(tag)加以区别。尽管这些字符串使用同样的名字，Ren’Py把这些稍有差别的字符串看作需要多语言支持：</p>
<div class="highlight-renpy notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;New&quot;</span>
<span class="s2">&quot;New{#project}&quot;</span>
<span class="s2">&quot;New{#game}&quot;</span>
<span class="s2">&quot;New{#playlist}&quot;</span>
</pre></div>
</div>
<p>translate字符串语句可以用来对None语言脚本的转换。在使用非英语编写的游戏中，translate字符串语句可以用来转换Ren’Py的用户接口。:</p>
<div class="highlight-renpy notranslate"><div class="highlight"><pre><span></span><span class="k">translate</span> <span class="bp">None</span> <span class="k">strings</span><span class="p">:</span>
     <span class="k">old</span> <span class="s2">&quot;Start Game&quot;</span>
     <span class="k">new</span> <span class="s2">&quot;Artstay Amegay&quot;</span>
</pre></div>
</div>
<div class="section" id="translating-substitutions">
<span id="id9"></span><h3>多语言替换<a class="headerlink" href="#translating-substitutions" title="Permalink to this headline"> link</a></h3>
<p>!t标志用于表示多语言的字符串转换。下面这段脚本使用了原对话和多语言字符串的组合：</p>
<div class="highlight-renpy notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">mood_points</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">:</span>
    <span class="k">$</span> <span class="n">mood</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s2">&quot;great&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">$</span> <span class="n">mood</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s2">&quot;awful&quot;</span><span class="p">)</span>

<span class="s2">&quot;I&#39;m feeling [mood!t].&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="extract-merge-translations">
<span id="id10"></span><h3>提取和复用多语言字符串<a class="headerlink" href="#extract-merge-translations" title="Permalink to this headline"> link</a></h3>
<p>多语言字符串可以从某个项目中提取，然后移植到另一个项目。完成这点需要以下步骤：</p>
<ul class="simple">
<li>选取来源项目，并选择“生成翻译文件”。</li>
<li>输入需要提取的语言，并点击“导出字串翻译”。</li>
<li>回到主菜单，选取目标项目，并选择“生成翻译文件”。</li>
<li>输入需要复用的语言(通常与之前提取的语言相通)，并选择“合并字串翻译”。</li>
</ul>
<p>这里有两个选项，控制语言的复用功能：</p>
<dl class="docutils">
<dt>替换已存在的翻译</dt>
<dd>如果选用这项，已经存在的重要翻译文件会被覆盖。默认情况下，复用过程会拒绝覆盖已经存在的重要翻译文件。</dd>
<dt>反转语言</dt>
<dd>在复用之前反转主备语言类型。例如，使用一个原本英语为主语言俄语为备选语言的项目，复用为“俄语为主语言英语为备选语言”的项目时，就需要勾选该项。</dd>
</dl>
</div>
</div>
<div class="section" id="image-and-file-translations">
<span id="id11"></span><h2>图片和文件的多语言支持<a class="headerlink" href="#image-and-file-translations" title="Permalink to this headline"> link</a></h2>
<p>当让一个游戏支持多语言时，最好替换文件时带一个语言版本号。例如，某个图片包含文本，最好的办法是使用带其他文字的图片替换。而那个新的图片带一个语言版本号。</p>
<p>Ren’Py遇到这种情况时，会在translation文件夹里寻找对应的图片。例如，假如使用了“piglatin”语言，并加载了“library.png”图片，Ren’Py就会使用“game/tl/piglatin/library.png”图片代替“game/library.png”。</p>
</div>
<div class="section" id="style-translations">
<span id="id12"></span><h2>样式的多语言支持<a class="headerlink" href="#style-translations" title="Permalink to this headline"> link</a></h2>
<p>当对某个游戏实现多语言支持时，最好变更样式(style)——特别是那些与字体相关的样式。Ren’Py使用多语言样式语句块(block)和多语言python语句块处理这类情况。这些语句块(block)可以更改语言相关的变量和样式。例如：</p>
<div class="highlight-renpy notranslate"><div class="highlight"><pre><span></span><span class="k">translate</span> <span class="n">piglatin</span> <span class="k">style</span> <span class="k">default</span><span class="p">:</span>
    <span class="na">font</span> <span class="s2">&quot;stonecutter.ttf&quot;</span>
</pre></div>
</div>
<p>以及等效的：</p>
<div class="highlight-renpy notranslate"><div class="highlight"><pre><span></span><span class="k">translate</span> <span class="n">piglatin</span> <span class="k">python</span><span class="p">:</span>
    <span class="k">style</span><span class="o">.</span><span class="k">default</span><span class="o">.</span><span class="na">font</span> <span class="o">=</span> <span class="s2">&quot;stonecutter.ttf&quot;</span>
</pre></div>
</div>
<p>当某种语言被激活——无论是游戏开始时还是中途修改语言——Ren’Py都会重设初始化环节内所有样式的内容。Ren’Py会运行所有与当前激活语言相关的translate python语句块和translate style语句块，保证文件中这些语句块被优先执行。最后，Ren’Py会重建所有样式，并使语言修改生效。</p>
<p>样式的多语言支持可以添加在任何.rpy文件中。</p>
</div>
<div class="section" id="default-language">
<span id="id13"></span><h2>默认语言<a class="headerlink" href="#default-language" title="Permalink to this headline"> link</a></h2>
<p>使用以下方法可以选择默认语言：</p>
<ul class="simple">
<li>根据设置的RENPY_LANGUAGE环境变量。</li>
<li>根据设置的 <a class="reference internal" href="config.html#var-config.language"><code class="xref std std-var docutils literal notranslate"><span class="pre">config.language</span></code></a> 。</li>
<li>使用之前游戏中选择的语言选项。</li>
<li>游戏第一次运行时，使用 <code class="xref std std-var docutils literal notranslate"><span class="pre">config.default_language</span></code> 。(默认使用None语言。)</li>
<li>以上情况都未配置，使用None语言。</li>
</ul>
</div>
<div class="section" id="translation-actions-functions-and-variables">
<span id="id14"></span><h2>多语言支持的动作、函数和变量<a class="headerlink" href="#translation-actions-functions-and-variables" title="Permalink to this headline"> link</a></h2>
<p>切换语言的主要办法是使用语言的行为函数。</p>
<dl class="function">
<dt id="Language">
<code class="descname">Language</code><span class="sig-paren">(</span><em>language</em><span class="sig-paren">)</span><a class="headerlink" href="#Language" title="Permalink to this definition"> link</a></dt>
<dd><p>将游戏语言改为  <em>language</em> 。</p>
<dl class="docutils">
<dt><cite>language</cite></dt>
<dd>一个字符串，表示切换的目标语言命，若为None表示游戏脚本默认语言。</dd>
</dl>
</dd></dl>

<p>语言行为函数可以用于在自定义配置界面添加一个语言自定义选项。</p>
<div class="highlight-renpy notranslate"><div class="highlight"><pre><span></span><span class="k">frame</span><span class="p">:</span>
    <span class="na">style_prefix</span> <span class="s2">&quot;pref&quot;</span>
    <span class="k">has</span> <span class="k">vbox</span>

    <span class="k">label</span> <span class="n">_</span><span class="p">(</span><span class="s2">&quot;Language&quot;</span><span class="p">)</span>
    <span class="k">textbutton</span> <span class="s2">&quot;English&quot;</span> <span class="na">action</span> <span class="n">Language</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
    <span class="k">textbutton</span> <span class="s2">&quot;Igpay Atinlay&quot;</span> <span class="na">action</span> <span class="n">Language</span><span class="p">(</span><span class="s2">&quot;piglatin&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>总共有两个与多语言支持相关的函数：</p>
<dl class="function">
<dt id="renpy.change_language">
<code class="descclassname">renpy.</code><code class="descname">change_language</code><span class="sig-paren">(</span><em>language</em><span class="sig-paren">)</span><a class="headerlink" href="#renpy.change_language" title="Permalink to this definition"> link</a></dt>
<dd><p>一个字符串，表示切换的目标语言命，若为None表示游戏脚本默认语言。</p>
</dd></dl>

<dl class="function">
<dt id="renpy.known_languages">
<code class="descclassname">renpy.</code><code class="descname">known_languages</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#renpy.known_languages" title="Permalink to this definition"> link</a></dt>
<dd><p>返回已知语言的集。不包含默认语言None。</p>
</dd></dl>

<p>此外，还有3个与字符串多语言支持相关的函数：</p>
<dl class="function">
<dt id="_">
<code class="descname">_</code><span class="sig-paren">(</span><em>s</em><span class="sig-paren">)</span><a class="headerlink" href="#_" title="Permalink to this definition"> link</a></dt>
<dd><p>(单下划线)返回字符串s的原语言内容。Ren’Py会搜寻该函数传入的字符串，并把它们加入到多语言支持字符串列表中。这些字符串不会转换为其他语言，直到他们被显示过。</p>
</dd></dl>

<dl class="function">
<dt id="__">
<code class="descname">__</code><span class="sig-paren">(</span><em>s</em><span class="sig-paren">)</span><a class="headerlink" href="#__" title="Permalink to this definition"> link</a></dt>
<dd><p>(双下划线)返回字符串s转换成当前语言后的内容。该函数返回的字符串会被加入到多语言支持字符串列表中。注意字符串可以经历过双重转换。如果其匹配到一个对应的多语言字符串则显示转换后的结果。</p>
<dl class="function">
<dt id="_p">
<code class="descname">_p</code><span class="sig-paren">(</span><em>s</em><span class="sig-paren">)</span><a class="headerlink" href="#_p" title="Permalink to this definition"> link</a></dt>
<dd><p>将一个字符串重新格式化并标记其是支持多语言的。使用文本组件显示的字符串是转换过语言的。该函数的用途是，使用表单格式(form)定义多行字符串：</p>
</dd></dl>

<div class="highlight-renpy notranslate"><div class="highlight"><pre><span></span><span class="k">define</span> <span class="n">config</span><span class="o">.</span><span class="n">about</span> <span class="o">=</span> <span class="n">_p</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    These two lines will be combined together</span>
<span class="s2">    to form a long line.</span>

<span class="s2">    This line will be separate.</span>
<span class="s2">    &quot;&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>重新格式化会将整段文本断行，移除每行开头和结尾的空白。整段文本末尾的空白行会被删除。段落中的空白行会被插入段落分割符。{p}文本标签(tag)可以断行，但不会增加新的空白行。</p>
<p>在字符串多语言支持中的使用方式如下：</p>
<div class="highlight-renpy notranslate"><div class="highlight"><pre><span></span><span class="k">old</span> <span class="s2">&quot;These two lines will be combined together to form a long line.</span><span class="se">\n\n</span><span class="s2">This line will be separate.&quot;</span>
<span class="k">new</span> <span class="n">_p</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    These two lines will be combined together</span>
<span class="s2">    to form a long line. Bork bork bork.</span>

<span class="s2">    This line will be separate. Bork bork bork.</span>
<span class="s2">    &quot;&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<p>这里有两个语言相关的变量。一个是
<a class="reference internal" href="config.html#var-config.language"><code class="xref std std-var docutils literal notranslate"><span class="pre">config.language</span></code></a> ，用于改变游戏默认语言。</p>
<dl class="var">
<dt id="var-_preferences.language">
<code class="descname">_preferences.language</code><a class="headerlink" href="#var-_preferences.language" title="Permalink to this definition"> link</a></dt>
<dd><p>当前语言名称，如果使用的是默认语言则是None。需要改变语言的话，调用 <a class="reference internal" href="#renpy.change_language" title="renpy.change_language"><code class="xref py py-func docutils literal notranslate"><span class="pre">renpy.change_language()</span></code></a> 函数。</p>
</dd></dl>

</div>
<div class="section" id="unsanctioned-translations">
<span id="id15"></span><h2>非常规多语言支持<a class="headerlink" href="#unsanctioned-translations" title="Permalink to this headline"> link</a></h2>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">创建非常规多语言支持前，最好获取原游戏创作者的许可。</p>
</div>
<p>在没有游戏创作者原生支持的情况下，Ren’Py也有一点支持可以创建多语言支持。Ren’Py能根据游戏内所有字符串自动生成一个字符串多语言支持的文件。因为多语言字符串可以用在未转换过的对话，这个小技巧可以让游戏直接支持多语言。</p>
<p>想要创建一个字符串翻译文件，需要执行以下步骤：</p>
<ul class="simple">
<li>设置环境变量RENPY_LANGUAGE为你想要添加的目标语言。</li>
<li>设置环境变量RENPY_UPDATE_STRINGS为一个非空值。</li>
<li>执行游戏直到看见目标文本内容。</li>
</ul>
<p>这些操作会更新“game/tl/language/strings.rpy”文件，其中包含所有多语言字符串的一个模板。</p>
<p>如果某个游戏内部不支持更改语言，可以在 <a class="reference internal" href="config.html#var-config.language"><code class="xref std std-var docutils literal notranslate"><span class="pre">config.language</span></code></a>
中使用一个init python语句块(block)，强行切换到目标语言。</p>
<p>除了使用字符串的多语言支持解决对话的问题，上面描述的非常规多语言支持技巧也可以应用在图片和样式上。</p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">返回顶部</a>
      
    </p>
    <p>
        &copy; Copyright 2012-2018, Tom Rothamel.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.6.<br/>
    </p>
  </div>
</footer>
  </body>
</html>